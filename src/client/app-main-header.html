<dom-module id="app-main-header">
  <style>
    .header-wrapper{
      width:100%;
    }
    .otherviewer{
      text-align: center;
      font-style: italic;
      color: #8A97DC;
    }
    .subtitle{
      color: #B4BDEF;
    }
    paper-toolbar{
      background-color: #5E6FC7;
      padding: 20px;
    }
    paper-tab{
      background-color: #EEE;
    }
    paper-tab iron-icon{
      color: #767676;
    }
    paper-tabs paper-tab.iron-selected {
      color: #5A5A5A;
      background-color: #BDBDBD;
    }
  </style>
  <template>
    <paper-toolbar class="medium-tall">
      <div class="header-wrapper">
        <div class="otherviewer">XXX is also viewing</div>
        <div class="title">{{jobname}}</div>
        <div class="subtitle">{{statusTitle}}</div>
      </div>
    </paper-toolbar>
    <paper-tabs id="funcTab" selected="{{tab}}" no-bar noink>
      <paper-tab>
        <iron-icon icon="communication:message"></iron-icon>
      </paper-tab>
      <paper-tab>
        <iron-icon icon="social:person-add"></iron-icon>
      </paper-tab>
      <paper-tab>
        <iron-icon icon="communication:business"></iron-icon>
      </paper-tab>
      <paper-tab>
        <iron-icon icon="image:brush"></iron-icon>
      </paper-tab>
      <paper-tab>
        <iron-icon icon="file-upload"></iron-icon>
      </paper-tab>
    </paper-tabs>
    <content></content>
  </template>
  
  <script>
    Polymer({
      is: 'app-main-header',
      properties: {
        job: {
          type: Object,
          value: null,
          notify: true,
          observer: 'setJobData'
        },
        jobid: {
          type: String,
          notify: true
        },
        jobname: {
          type: String,
          notify: true
        },
        time: {
          type: String,
          notify: true
        },
        status: {
          type: String,
          notify: true
        },
        assignee: {
          type: String,
          notify: true
        },
        updater: {
          type: String,
          notify: true
        },
        statusTitle: {
          type: String,
          notify: true
        },
        viewurl:{
          type: String,
          notify: true
        },
        tab: {
          type: String,
          notify: true,
          value: 0
        }
      },
      ready: function(){
        var myKey = '9ucmktt493ndyfnp9lvpwmsfky8dmtc7';
        var boxViewLib = require('../../node_modules/node-box-view');
        var boxView = new boxViewLib(myKey);
        // var client = boxView.createClient(myKey);
        
        // upload
        // boxView.uploadFile('/documents/designashirt/artexpress/src/client/text.txt', {}, function(err, res){
        //   console.log('err', err);
        //   console.log('res', res);
        //   boxView.getList(null, function(err, res){console.log('list', res)});
        // });
        
        // boxView.uploadFile('/documents/designashirt/artexpress/src/client/lake.pdf', {}, function(err, res){
        //   boxView.getList(null, function(err, res){console.log('list', res)});
        // });
        // boxView.getList(null, function(err, res){console.log('list', res)});

        // boxView.getDocument('d38857ad016f4a988cddb87bff862052', [], function(err, res){
          // boxView.getDocumentThumbnail('85f1375815f3480cb55499fcae7df336', 800, 500, '/documents/designashirt/artexpress/src/client/thumb.bmp', function(err,res){
          //   console.log(err, res);
          // });
        // });

        // var that = this;
        // // boxView.getDocumentSession(documentId, callback)
        // boxView.getDocumentSession('85f1375815f3480cb55499fcae7df336', function(err, res){
        //   console.log(err, res);
        //   that.viewurl = res.urls.view + '?theme=dark';
        //   console.log(res.urls.view);
        // });

        //getDocumentThumbnail(documentId, width, height, file, callback)
        // boxView.getDocumentThumbnail('d38857ad016f4a988cddb87bff862052', 512, 384,  '/documents/designashirt/artexpress/src/client/res.jpg', function(err,res){
        //   console.log(err, res);
        // });

        // client.documents.uploadFile(
        //   '/documents/designashirt/artexpress/src/client/text.txt', null, function(err, res){
        //     console.log(1111, err, res);
        //     client.documents.list(function (err, list, res) {console.log('list', list);});
        //     console.log(2222)
        //   }
        // );

        // client.documents.list(function (err, list, res) {console.log('list', list.document_collection);});
        // client.documents.getContent("e559be00dcbf49dd90be35c90ab7cf6e", function(err, res){console.log(res)})
      },
      setJobData: function(newValue, oldValue){
        if(!!newValue){
          this.jobid = newValue.id;
          this.jobname = newValue.name;
          this.time = moment(newValue.updatedAt).format("MMM DD, YYYY, h:mm:ss a");
          this.assignee = newValue.username;
          // this.updater = newValue.updater;
          this.status = newValue.status;
          this.statusTitle = this.status + '. Updated at ' + this.time; 
        }
      } 
    });
  </script>
</dom-module>