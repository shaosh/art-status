<dom-module id="job-card">
  <style>
    :host{
      --grey-color: #5A5A5A;
    }
    paper-card {
      width: 100%;
      margin-bottom: 2px;
    }
    .selected {
      background-color: #7EC1F4;
    }
    .avatar {
      display: inline-block;
      height: 64px;
      width: 64px;
      border-radius: 50%;
      background-size:contain;
      background-color:var(--grey-color);
      color: white;
      line-height: 64px;
      font-size: 30px;
      text-align: center;
      border: var(--grey-color) 2px solid;
    }
    .title {
      position: absolute;
      top: 20px;
      left: 100px;
      width: 250px;
    }
    .medium {
      font-size: 16px;
      padding-bottom: 15px;
    }
    .small {
      font-size: 12px;
      color: var(--grey-color);
    }
    .status{
      display: inline-block;
      position: absolute;
      right: 20px;
      top: 30px;
      color: var(--grey-color);
    }
  </style>
  
  <template>
    <paper-card>
      <div class="card-content">
        <div class="avatar" id="avatar" style="background-image: url('{{avatarurl}}');"></div>
        <paper-tooltip for="avatar">{{assignee}}</paper-tooltip>
        <div class="title">
          <div class="medium"><span class="jobid">{{jobid}}</span> - <span>{{jobname}}</span></div>
          <div class="small">{{time}}</div>
        </div>
        <div class="status">
          <iron-icon icon="{{statusIcon}}"></iron-icon>
          <paper-tooltip>{{status}}</paper-tooltip>
        </div>
      </div>
    </paper-card>
  </template>
  
  <script>
    Polymer({
      is: 'job-card',
      properties: {
        job: {
          type: Object,
          value: null,
          notify: true,
          observer: '_setJobData'
        },
        jobid:{
          type: String,
          notify: true
        },
        jobname: {
          type: String,
          notify: true
        },
        selected: {
          type: String,
          value: ''
        },
        time: {
          type: String,
          notify: true
        },
        status: {
          type: String,
          notify: true
        },
        statusIcon: {
          type: String,
          notify: true
        },
        assignee: {
          type: String,
          notify: true
        }
      },
      _setJobData: function(newValue, oldValue){
        if(!!newValue){
          this.jobid = newValue.id;
          this.jobname = newValue.name;
          this.time = newValue.time;
          this.assignee = newValue.assignee;
          this.status = newValue.status;          
          
          if(this.status === STATUSES.WORKING){
            this.statusIcon = 'tab';
          } 
          else if(this.status === STATUSES.WAITING){
            this.statusIcon = 'schedule';
          }
          else if(this.status === STATUSES.LOCKED){
            this.statusIcon = 'announcement';
          }
          else{
            this.statusIcon = 'check-circle';
          }
          //TODO: use api to get the url to the profile img
          var avatar = this.$$('.avatar');
          var name = this.assignee.toLowerCase();
          var url = ''
          if(['hill', 'jessie', 'mike', 'zack'].indexOf(name) > -1){
            url = '/pages/img/' + name + '.jpg';
          }
          else{
            url = '/pages/img/default.png';
          }
          avatar.style.backgroundImage = 'url(' + url + ')';
        }
      } 
    })
  </script>
</dom-module>